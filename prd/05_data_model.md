## **Data Model**

### **PostgreSQL (Relational Database)**

The PostgreSQL database is the source of truth for all structured data, including user accounts, projects, and metadata about data sources.

#### **1. `users` Table**

Stores user account information.

- `id` (SERIAL, PRIMARY KEY): Unique identifier for the user.
- `username` (VARCHAR, UNIQUE, NOT NULL): The user's unique username.
- `hashed_password` (TEXT, NOT NULL): The user's password, securely hashed using bcrypt.
- `first_name` (VARCHAR): The user's first name.
- `last_name` (VARCHAR): The user's last name.

---

#### **2. `projects` Table**

Stores information about user-created projects, which act as containers for data and analyses.

- `id` (SERIAL, PRIMARY KEY): Unique identifier for the project.
- `name` (VARCHAR, NOT NULL): The name of the project.
- `description` (TEXT): An optional description of the project.
- `user_id` (INTEGER, FOREIGN KEY to `users.id`): The ID of the user who owns the project.
- `created_at` (TIMESTAMP): The timestamp when the project was created.

---

#### **3. `data_sources` Table**

Stores metadata for the data files uploaded by users.

- `id` (SERIAL, PRIMARY KEY): Unique identifier for the data source.
- `project_id` (INTEGER, FOREIGN KEY to `projects.id`): The ID of the project this data source belongs to.
- `file_name` (VARCHAR, NOT NULL): The original name of the uploaded file (e.g., `sales_data.csv`).
- `file_path` (TEXT, NOT NULL): The path on the server's file system where the uploaded file is stored.
- `created_at` (TIMESTAMP): The timestamp when the data source was uploaded.

---

### **MongoDB (NoSQL Document Database)**

MongoDB is used to store the flexible, semi-structured content of the analysis canvases. This allows for a schema that can easily evolve as new types of content blocks (charts, tables, text) are added.

#### **1. `canvases` Collection**

Each document in this collection represents a single analysis canvas.

- `_id` (ObjectId): Unique identifier for the canvas document, automatically generated by MongoDB.
- `project_id` (INTEGER): The ID of the project the canvas belongs to, linking it back to the PostgreSQL `projects` table.
- `name` (String): The name of the canvas.
- `content` (Object): A JSON object representing the state of the canvas, including the layout and configuration of all its elements (e.g., charts, tables, text blocks).
- `created_at` (ISODate): The timestamp when the canvas was created.

---

### **File System**

The local file system on the backend server is used for storing the raw, unmodified files uploaded by users.

- **`uploads/` Directory**: This directory contains all the raw CSV files that users have uploaded. The `file_path` in the `data_sources` table points to a file within this directory.
